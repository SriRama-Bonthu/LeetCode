class Solution {
    public int maxSum(int[][] grid) {
        int n=grid[0].length;
        int m=grid.length;
       int[][] pre=new int[m][n];
       for(int i=0;i<m;i++){
        pre[i][0]=grid[i][0];
        int s=0;
        for(int j=1;j<n;j++){
            pre[i][j]=pre[i][j-1]+grid[i][j];
        }
       }
       int max=0;
       for(int i=0;i<=m-1-2;i++){
        int s=0;
        for(int j=2;j<n;j++){
            if(j>2){
                s=(pre[i][j]-pre[i][j-3]+pre[i+2][j]-pre[i+2][j-3]+grid[i+1][j-1]);
            }
            else{
                s=pre[i][j]+pre[i+2][j]+grid[i+1][j-1];
            }
            max=Math.max(s,max);
        }
       }
       return max;
    }
}
